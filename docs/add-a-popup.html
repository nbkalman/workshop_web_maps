<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Add a popup | Building Web Maps with Leaflet</title>
  <meta name="description" content="7 Add a popup | Building Web Maps with Leaflet" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Add a popup | Building Web Maps with Leaflet" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="ucdavisdatalab/workshop_web_maps" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Add a popup | Building Web Maps with Leaflet" />
  
  
  

<meta name="author" content="Dr. Michele Tobias" />
<meta name="author" content="Arthur Koehl" />
<meta name="author" content="Naomi Kalman" />


<meta name="date" content="2023-04-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="use-external-data.html"/>
<link rel="next" href="put-your-web-page-online.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>




</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://datalab.ucdavis.edu/">
  <img src="https://datalab.ucdavis.edu/wp-content/uploads/2019/07/datalab-logo-full-color-rgb-1.png" style="height: 100%; width: 100%; object-fit: contain" />
</a></li>
<li><a href="./" style="font-size: 18px">Building Web Maps with Leaflet</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#description"><i class="fa fa-check"></i><b>0.1</b> Description</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#learning-objectives"><i class="fa fa-check"></i><b>0.2</b> Learning Objectives</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#skills"><i class="fa fa-check"></i><b>0.3</b> Skills</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i><b>0.4</b> Prerequisites</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#software-tools"><i class="fa fa-check"></i><b>0.5</b> Software &amp; Tools</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-is-a-web-map"><i class="fa fa-check"></i><b>1.1</b> What is a “Web Map”?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#why-make-a-web-map"><i class="fa fa-check"></i><b>1.2</b> Why make a web map?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#examples"><i class="fa fa-check"></i><b>1.3</b> Examples</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#workflow"><i class="fa fa-check"></i><b>1.4</b> Workflow</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#leaflet"><i class="fa fa-check"></i><b>1.5</b> Leaflet</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="introduction.html"><a href="introduction.html#other-web-map-tools"><i class="fa fa-check"></i><b>1.5.1</b> Other Web Map Tools</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#workshop-data-uc-davis-campus-food"><i class="fa fa-check"></i><b>1.6</b> Workshop Data: UC Davis Campus Food</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="set-up.html"><a href="set-up.html"><i class="fa fa-check"></i><b>2</b> Set Up</a>
<ul>
<li class="chapter" data-level="2.1" data-path="set-up.html"><a href="set-up.html#download-the-data"><i class="fa fa-check"></i><b>2.1</b> Download the Data</a></li>
<li class="chapter" data-level="2.2" data-path="set-up.html"><a href="set-up.html#folders"><i class="fa fa-check"></i><b>2.2</b> Folders</a></li>
<li class="chapter" data-level="2.3" data-path="set-up.html"><a href="set-up.html#files"><i class="fa fa-check"></i><b>2.3</b> Files</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="build-a-webpage.html"><a href="build-a-webpage.html"><i class="fa fa-check"></i><b>3</b> Build a Webpage</a>
<ul>
<li class="chapter" data-level="3.1" data-path="build-a-webpage.html"><a href="build-a-webpage.html#intro-to-html"><i class="fa fa-check"></i><b>3.1</b> Intro to HTML</a></li>
<li class="chapter" data-level="3.2" data-path="build-a-webpage.html"><a href="build-a-webpage.html#start-building-your-webpage"><i class="fa fa-check"></i><b>3.2</b> Start Building your Webpage</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="prepare-your-page-for-a-leaflet-web-map.html"><a href="prepare-your-page-for-a-leaflet-web-map.html"><i class="fa fa-check"></i><b>4</b> Prepare Your Page for a Leaflet Web Map</a>
<ul>
<li class="chapter" data-level="4.1" data-path="prepare-your-page-for-a-leaflet-web-map.html"><a href="prepare-your-page-for-a-leaflet-web-map.html#load-the-external-files"><i class="fa fa-check"></i><b>4.1</b> Load The External Files</a></li>
<li class="chapter" data-level="4.2" data-path="prepare-your-page-for-a-leaflet-web-map.html"><a href="prepare-your-page-for-a-leaflet-web-map.html#add-a-map-div"><i class="fa fa-check"></i><b>4.2</b> Add a Map Div</a></li>
<li class="chapter" data-level="4.3" data-path="prepare-your-page-for-a-leaflet-web-map.html"><a href="prepare-your-page-for-a-leaflet-web-map.html#add-a-script-section"><i class="fa fa-check"></i><b>4.3</b> Add a Script Section</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="add-a-map.html"><a href="add-a-map.html"><i class="fa fa-check"></i><b>5</b> Add a Map</a>
<ul>
<li class="chapter" data-level="5.1" data-path="add-a-map.html"><a href="add-a-map.html#add-a-map-1"><i class="fa fa-check"></i><b>5.1</b> Add A Map</a></li>
<li class="chapter" data-level="5.2" data-path="add-a-map.html"><a href="add-a-map.html#add-a-marker"><i class="fa fa-check"></i><b>5.2</b> Add a Marker</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="use-external-data.html"><a href="use-external-data.html"><i class="fa fa-check"></i><b>6</b> Use External Data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="use-external-data.html"><a href="use-external-data.html#about-geojson"><i class="fa fa-check"></i><b>6.1</b> About GeoJSON</a></li>
<li class="chapter" data-level="6.2" data-path="use-external-data.html"><a href="use-external-data.html#formatting-the-data"><i class="fa fa-check"></i><b>6.2</b> Formatting the Data</a></li>
<li class="chapter" data-level="6.3" data-path="use-external-data.html"><a href="use-external-data.html#read-the-data"><i class="fa fa-check"></i><b>6.3</b> Read the Data</a></li>
<li class="chapter" data-level="6.4" data-path="use-external-data.html"><a href="use-external-data.html#add-data-to-the-map"><i class="fa fa-check"></i><b>6.4</b> Add Data to the Map</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="add-a-popup.html"><a href="add-a-popup.html"><i class="fa fa-check"></i><b>7</b> Add a popup</a>
<ul>
<li class="chapter" data-level="7.1" data-path="add-a-popup.html"><a href="add-a-popup.html#add-a-popup-1"><i class="fa fa-check"></i><b>7.1</b> Add a popup</a></li>
<li class="chapter" data-level="7.2" data-path="add-a-popup.html"><a href="add-a-popup.html#customize-popup-text-with-data"><i class="fa fa-check"></i><b>7.2</b> Customize Popup Text with Data</a></li>
<li class="chapter" data-level="7.3" data-path="add-a-popup.html"><a href="add-a-popup.html#add-details-to-the-popup-text"><i class="fa fa-check"></i><b>7.3</b> Add details to the popup text</a></li>
<li class="chapter" data-level="7.4" data-path="add-a-popup.html"><a href="add-a-popup.html#add-a-description-to-the-popup"><i class="fa fa-check"></i><b>7.4</b> Add a description to the popup</a></li>
<li class="chapter" data-level="7.5" data-path="add-a-popup.html"><a href="add-a-popup.html#add-an-image-to-the-popup"><i class="fa fa-check"></i><b>7.5</b> Add an image to the popup</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="put-your-web-page-online.html"><a href="put-your-web-page-online.html"><i class="fa fa-check"></i><b>8</b> Put Your Web Page online</a></li>
<li class="chapter" data-level="9" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>9</b> Resources</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Building Web Maps with Leaflet</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="add-a-popup" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">7</span> Add a popup<a href="add-a-popup.html#add-a-popup" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>START FROM HERE:</strong> You can keep working on your code from the previous section, or use the <a href="https://github.com/ucdavisdatalab/workshop_web_maps/blob/main/example_code/end_of_sec_6.html">example code up to this point in the workshop</a>.</p>
<p>Next we’ll add popups to our points.</p>
<div id="add-a-popup-1" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Add a popup<a href="add-a-popup.html#add-a-popup-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It would be nice to have some information available for each marker. Let’s make a popup that tells us about each location. We’ll start with a text popup and gradually add more to it.</p>
<p>We made our markers for our point locations by iterating over the list of features in our dataset and making a marker for each of them. We can add a function to the one we already have so that once the markers get made, each will get a popup.</p>
<p>We’ll modify our code that adds our points to look like this:</p>
<pre><code>    //add food points from the GeoJSON (campus_food.js) file

    var foodpoints = L.geoJSON(campus_food, {  
        pointToLayer: function(feature, latlng){  
            return L.circleMarker(latlng, {color: &#39;orange&#39;, radius: 8});
        }<span style="background-color:#ffff7f">,
        onEachFeature: function(feature, layer){
            layer.bindPopup(&quot;This is a popup!&quot;);
        }</span>
    }).addTo(foodmap);</code></pre>
<p><img src="images/webpage_section_7-1.png" title="The web map now has popups that contain place-holder text" /></p>
<p>What did we do? After the <code>pointToLayer</code> function, we added a new created a new function called <code>OnEachFeature</code> that uses the feature (each row of the data) and the layer information. For each feature, we have it bind a popup to our layer (named <em>foodpoints</em>) and put the text that is in the parentheses into the popup. For now, all of our popups will say “This is a popup!”. We’ll build on that next.</p>
</div>
<div id="customize-popup-text-with-data" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Customize Popup Text with Data<a href="add-a-popup.html#customize-popup-text-with-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This is progress! We have a map with points and popups that contain placeholder text. Let’s use the attribute data from our <em>foodpoints</em> layer to add the name of each location to the popup.</p>
<p>Instead of the “This is a popup!” text, we can use the attribute data from our foodpoints data. Replace the current “This is a popup!” text with: <code>feature.properties.Name</code> (with no quotes around it). As we loop through each row of our data, the code will add each location’s name to the popup.</p>
<pre><code>    //add food points from the GeoJSON (campus_food.js) file

    var foodpoints = L.geoJSON(campus_food, {  
        pointToLayer: function(feature, latlng){  
            return L.circleMarker(latlng, {color: &#39;orange&#39;, radius: 8});
        },
        onEachFeature: function(feature, layer){
            layer.bindPopup(<span style="background-color:#ffff7f">feature.properties.Name</span>);
        }
    }).addTo(foodmap);</code></pre>
<p><img src="images/webpage_section_7-2.png" title="The popups now have the locations&#39; names." /></p>
</div>
<div id="add-details-to-the-popup-text" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Add details to the popup text<a href="add-a-popup.html#add-details-to-the-popup-text" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>What if we want to give the popup more context?</p>
<p>The text for the popup can be plain text, but we can also use HTML to style the text like a very small webpage. (If your head is starting to spin from switching languages… HTML page containing JavaScript containing HTML… this is normal.) We’ll start small and build up to something more complex.</p>
<p>Maybe we want to indicate that the text in the popup is the name of the location. We can concatenate (paste together) some text with HTML styling with our code to get the location names: <code>"&lt;b&gt;Name: &lt;/b&gt;" + feature.properties.Name</code></p>
<pre><code>    //add food points from the GeoJSON (campus_food.js) file

    var foodpoints = L.geoJSON(campus_food, {  
        pointToLayer: function(feature, latlng){  
            return L.circleMarker(latlng, {color: &#39;orange&#39;, radius: 8});
        },
        onEachFeature: function(feature, layer){
            layer.bindPopup(<span style="background-color:#ffff7f">&quot;&lt;b&gt;Name: &lt;/b&gt;&quot; + </span>feature.properties.Name);
        }
    }).addTo(foodmap);</code></pre>
<p>Our popups are starting to be much more useful!</p>
<p><img src="images/webpage_section_7-3.png" title="A popup indicating that the data presented is the name field" /></p>
</div>
<div id="add-a-description-to-the-popup" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Add a description to the popup<a href="add-a-popup.html#add-a-description-to-the-popup" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ready to get a little more complex? Let’s add a description of the location. We can use <code>&lt;br&gt;</code> to create a line break and put text onto a new line: <code>"&lt;b&gt;Name: &lt;/b&gt;" + feature.properties.Name + "&lt;br&gt;&lt;b&gt;Description: &lt;/b&gt;"+ feature.properties.description</code> This gets harder to read the longer it gets, so sometimes it helps to write the HTML pieces on separate lines, and once you’re ready to run it, put all the text onto one line. The text portion of our popup text needs to be wrapped in quotation marks but the calls for the data should not be.</p>
<pre><code>    //add food points from the GeoJSON (campus_food.js) file

    var foodpoints = L.geoJSON(campus_food, {  
        pointToLayer: function(feature, latlng){  
            return L.circleMarker(latlng, {color: &#39;orange&#39;, radius: 8});
        },
        onEachFeature: function(feature, layer){
            layer.bindPopup(&quot;&lt;b&gt;Name: &lt;/b&gt;&quot; + feature.properties.Name <span style="background-color:#ffff7f">+ &quot;&lt;br&gt;&lt;b&gt;Description: &lt;/b&gt;&quot;+ feature.properties.description</span>);
        }
    }).addTo(foodmap);</code></pre>
<p><img src="images/webpage_section_7-4.png" title="A popup with the name and text description of a location" /></p>
</div>
<div id="add-an-image-to-the-popup" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Add an image to the popup<a href="add-a-popup.html#add-an-image-to-the-popup" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In our data, we have a column that has a link to a picture of each location. Let’s put the picture at the top of the popup. The <code>&lt;img&gt;</code> tag will add an image to our popup. Because our images are stored as relative paths instead of hosted somewhere online, we get the image name stored with each food location in the geojson and use it to point to the image name in the img folder that is saved in the docs folder:</p>
<p><code>"&lt;img src='images/"+feature.properties.img_name +"' width='259'&gt;&lt;br&gt;&lt;b&gt;Name: &lt;/b&gt;" + feature.properties.Name + "&lt;br&gt;&lt;b&gt;Description: &lt;/b&gt;"+ feature.properties.description</code></p>
<p>Here’s what the section of our code that adds the foodpoints marker should now look like:</p>
<pre><code>    //add food points from the GeoJSON (campus_food.js) file

    var foodpoints = L.geoJSON(campus_food, {  
        pointToLayer: function(feature, latlng){  
            return L.circleMarker(latlng, {color: &#39;orange&#39;, radius: 8});
        },
        onEachFeature: function(feature, layer){
            layer.bindPopup(
                &quot;<span style="background-color:#ffff7f">&lt;img src=&#39;img/&quot; + feature.properties.img_name + &quot;&#39; width=&#39;259&#39;/&gt;&lt;br&gt;</span>&lt;b&gt;Name: &lt;/b&gt;&quot; + feature.properties.Name + &quot;&lt;br&gt;&lt;b&gt;Description: &lt;/b&gt;&quot;+ feature.properties.description);
        }
    }).addTo(foodmap);</code></pre>
<p>And here is our web map:</p>
<p><img src="images/webpage_section_7-5.png" title="A popup with a photo, name, and text description" /></p>
<p><strong>CHECK YOUR WORK:</strong> Compare your code with <a href="https://github.com/ucdavisdatalab/workshop_web_maps/blob/main/example_code/end_of_sec_7.html">example code up to this point in the workshop</a>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="use-external-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="put-your-web-page-online.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ucdavisdatalab/workshop_web_maps/edit/master/07_add_a_popup.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/ucdavisdatalab/workshop_web_maps/blob/master/07_add_a_popup.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
